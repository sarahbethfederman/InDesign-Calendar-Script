/** InDesign Academic Weekly Calendar Script* by Sarah Federman* Notes:* - add leapyear boolean eventually* - open the template file*/// Extend Array to include indexOf (not in jsx spec)Array.prototype.indexOf = function (elem, fromIndex){      fromIndex = fromIndex || 0;      for(var i = fromIndex; i < this.length; i++){          if(this[i] == elem){              return i;          }      }      return -1;  }// globalsvar myDoc = app.documents.add();var myPages = myDoc.pages;var pageCount = myPages.length;var monthsList = ["August", "September", "October", "November", "December", "January", "March", "February", "April", "May", "June", "July"];var days = ["Sunday", "Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var months = {};  // associative array of month name to month object// init functionfunction init() {    createMonths();    populateDoc();};// Month objectvar Month = function() {  // Constructor  function Month (name, startDay, dayCount) {    this.name = name;                   // name of the month    this.startDay = startDay;          // name of first day of the month (ex: August starts on a Friday)    this.dayCount = dayCount;       // total number of days in the month    this.labels = [];                       // list of labels for each day    this.populate();  }  // Methods  // Populate the labels list  Month.prototype.populate = function() {    var day = days.indexOf(this.startDay),        date;            for (var i = 0; i < this.dayCount; i++) {      date = (i + 1) + ": " + days[day];  // ex: "13: Friday"      this.labels[i] = date.toString();            // calculate next weekday      day = (day + 1) % 7;    }  }  return Month;}();// end month object// Create monthsfunction createMonths() {    var startDayIndex = days.indexOf("Friday"),  // August starts on Friday, index of Friday in days array      dayCount,      monthName;      // find how many days are in each month    function findDayCount (month) {      var dayCount;            if (month === "February") {        dayCount = 28;      }      else if (month !== "September" && month !== "April" && month !== "June" && month !== "November") {        dayCount = 31;      }      else {        dayCount = 30;      }            return dayCount;    }  for (var i = 0; i < monthsList.length; i++) {    monthName = monthsList[i];    dayCount = findDayCount(monthName);    // Fill the months associative array (month name to month object)    months[monthName] = new Month(monthName, days[startDayIndex], dayCount);    // Calculate what weekday next month starts on    startDayIndex = (startDayIndex + dayCount) % 7;  }}// populate function populateDoc(currentPage) {// for every 7 days// create two pages// fill those two pages// check if the last week is unfilledmyPages.add();myPages.add();var currentPage = 0;var labels = months["August"].labels;    for (var i = 0; i < labels.length; i++) {      // create the text frame      var myTextFrame = myPages[currentPage].textFrames.add();            // place the text frame      myTextFrame.geometricBounds = [ (6 + i)+ "p", (6 + i)+ "p", (24 + i)+ "p", (24 + i)+ "p"];            // fill the text frame      myTextFrame.contents = labels[i].toString();    }}// CALL INITinit();